---
title: "Week 10: Variogram calculation and modelling"
format:
  revealjs:
    slide-number: true
    show-slide-number: all
jupyter: python3 
---


## Variogram and h-scatter plots

![](basic_variogram.png)

source: [here](https://aegis4048.github.io/spatial-simulation-1-basics-of-variograms)

Mark h-scatter plots with positive correlation, no correlation, negative correlation

## Reason for variogram calculation: Kriging

![](inter.webp)

Image source: Pellicone, G., Caloiero, T., Modica, G., & Guagliardi, I. (2018). Application of several spatial interpolation techniques to monthly rainfall data in the Calabria region (southern Italy). International Journal of Climatology, 38(9), 3651-3666.

## Let's go back to the Porosity example

Data:https://github.com/GeostatsGuy/GeoDataSets/blob/master/1D_Porosity.csv



##

```{python}
#| echo: true
import pandas as pd
data = pd.read_csv('1D_Porosity.csv')
data
```

##

``````{python}
#| echo: true
data.head()
```

##

``````{python}
#| echo: true
data.tail()
```

## 


```{python}
#| echo: true
data.describe()
```

##

``````{python}
#| echo: true
import plotnine 
from plotnine import *
ggplot(data, aes(x="Depth", y="Nporosity"))+geom_line() + geom_point()
```

## variogram ploting with skgstat

```{python}
#| echo: true
#pip install scikit-gstat
import skgstat as skg
V = skg.Variogram(data['Depth'], data['Nporosity'])
V.plot()
```

## Increase the number of lags

```{python}
#| echo: true
V.maxlag = 25
V.n_lags = 25
V.plot()
```

##


The data set includes 40 observations, consequently we can increase the number of lag classes. 

```{python}
#| echo: true
V.maxlag = 40
V.n_lags = 40
V.plot()
```

## To iluustrate the other parameters in the skg.Variogram

```{python}
#| echo: true
V = skg.Variogram(data['Depth'], data['Nporosity'],
              normalize = False, model = "spherical", use_nugget = True,
              n_lags=40, maxlag=40)
V.plot()             
```

## For more details

https://scikit-gstat.readthedocs.io/en/latest/reference/variogram.html

## Calculating Experimental Variograms


![](search_template_1.png)

Source: [here](https://aegis4048.github.io/spatial-simulation-1-basics-of-variograms)

##

![](searchtem.png)

source: Vega, A. N. (1995). Geostatistical Analysis Applied to Mine Waste Characterization and Remediation (Doctoral dissertation, Colorado School of Mines).

## In-class: search template 

## In-class: seach template (scan across all possible locations)

## Choosing the directions (Choice of Azimuth (Directionality))

![](variogram_step_1.png)

Source: [here](https://aegis4048.github.io/spatial-simulation-1-basics-of-variograms)

## How do we find what directions you should calculate the variogram?

- Explore data

- Combining knowledge of geologists

- Azimuth angle in degrees clockwise from north

##

![](dv.jpeg)

 
Source: Trevisani, S., Cavalli, M., & Marchi, L. (2009). Variogram maps from LiDAR data as fingerprints of surface morphology on scree slopes. Natural Hazards and Earth System Sciences, 9(1), 129-133.

##

![](dv.jpeg)

Relationship between the variogram map and directional variograms. a) variogram 7 map of elevation data with profiles of directional variograms; b) directional variogram 8 calculated along the direction of maximum continuity, (dashed line in a); c) directional 9 variogram calculated along the direction of minimum continuity (continuous line in a)

## Guidance for Paprameter Setting when Calculating Variograms

- Lag separation: coincide with minimum data spacing

- Lag tolerance - 1/2 lag separation distance

- The variogram is only valid for a distance one-half of the field size.

##

![](calv.png)

Directly taken from https://www.youtube.com/playlist?list=PLG19vXLQHvSB-D4XKYieEku9GQMQyAzjJ. 


## 

Isotropic: independent of the direction of measurement 
##

![](ap_compare.png)

Source: https://geostatisticslessons.com/lessons/variogramanisotropy

## In-class

Variogram calculation in major and minor directions

## Python tutorials

[Tute 1 ](https://github.com/GeostatsGuy/PythonNumericalDemos/blob/master/GeostatsPy_variogram_calculation.ipynb)

[Tute 2](https://github.com/GeostatsGuy/PythonNumericalDemos/blob/master/Interactive_Variogram_Calculation.ipynb)

[Tute 3](https://scikit-gstat.readthedocs.io/en/latest/auto_examples/tutorial_03_variogram_models.html)

## Variogram Interpretations

![](70anisotropymapbined.png)

Source: https://www.researchgate.net/post/How-can-I-estimate-the-major-axis-and-ratio-values-from-directional-variogram-for-modeling-anisotropy

## Geometric Ansotropy

![](70anisotropymapbined.png)


## Other pattersn

- Cyclic

- Trend

- Zonal Anisotropy

##

![](trend.jpeg)
Source:https://www.researchgate.net/publication/341763241_Spatio-temporal_analysis_of_rainfall_extremes_in_the_flood-prone_Nagavali_and_Vamsadhara_Basins_in_eastern_India/figures?lo=1

##

![](srilanka.jpeg)

Source:https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.6405

##

![](cyclic.png)

https://esurf.copernicus.org/articles/9/845/2021/

## Variogram modelling

![](vmodes.gif)

## Python tutorial

[Tute 3](https://scikit-gstat.readthedocs.io/en/latest/auto_examples/tutorial_03_variogram_models.html)