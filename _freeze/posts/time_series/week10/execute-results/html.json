{
  "hash": "d1d35892a02f1e3ae87cdea4f878a686",
  "result": {
    "markdown": "---\ntitle: 'Week 10: Variogram calculation and modelling'\nformat:\n  revealjs:\n    slide-number: true\n    show-slide-number: all\n---\n\n## Variogram and h-scatter plots\n\n![](basic_variogram.png)\n\nsource: [here](https://aegis4048.github.io/spatial-simulation-1-basics-of-variograms)\n\nMark h-scatter plots with positive correlation, no correlation, negative correlation\n\n## Reason for variogram calculation: Kriging\n\n![](inter.webp)\n\nImage source: Pellicone, G., Caloiero, T., Modica, G., & Guagliardi, I. (2018). Application of several spatial interpolation techniques to monthly rainfall data in the Calabria region (southern Italy). International Journal of Climatology, 38(9), 3651-3666.\n\n## Let's go back to the Porosity example\n\nData:https://github.com/GeostatsGuy/GeoDataSets/blob/master/1D_Porosity.csv\n\n\n\n##\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\ndata = pd.read_csv('1D_Porosity.csv')\ndata\n```\n\n::: {.cell-output .cell-output-display execution_count=28}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Depth</th>\n      <th>Nporosity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.25</td>\n      <td>-1.37</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.50</td>\n      <td>-2.08</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.75</td>\n      <td>-1.67</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.00</td>\n      <td>-1.16</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.25</td>\n      <td>-0.24</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>1.50</td>\n      <td>-0.36</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1.75</td>\n      <td>0.44</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>2.00</td>\n      <td>0.36</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2.25</td>\n      <td>-0.02</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>2.50</td>\n      <td>-0.63</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>2.75</td>\n      <td>-1.26</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>3.00</td>\n      <td>-1.03</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>3.25</td>\n      <td>0.88</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>3.50</td>\n      <td>1.51</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>3.75</td>\n      <td>1.37</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>4.00</td>\n      <td>0.81</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>4.25</td>\n      <td>1.21</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>4.50</td>\n      <td>0.24</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>4.75</td>\n      <td>0.99</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>5.00</td>\n      <td>0.49</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>5.25</td>\n      <td>0.34</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>5.50</td>\n      <td>0.07</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>5.75</td>\n      <td>-0.26</td>\n    </tr>\n    <tr>\n      <th>23</th>\n      <td>6.00</td>\n      <td>-0.41</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>6.25</td>\n      <td>-0.14</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>6.50</td>\n      <td>-1.44</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>6.75</td>\n      <td>-0.75</td>\n    </tr>\n    <tr>\n      <th>27</th>\n      <td>7.00</td>\n      <td>-0.78</td>\n    </tr>\n    <tr>\n      <th>28</th>\n      <td>7.25</td>\n      <td>-0.85</td>\n    </tr>\n    <tr>\n      <th>29</th>\n      <td>7.50</td>\n      <td>-0.92</td>\n    </tr>\n    <tr>\n      <th>30</th>\n      <td>7.75</td>\n      <td>-0.66</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>8.00</td>\n      <td>0.47</td>\n    </tr>\n    <tr>\n      <th>32</th>\n      <td>8.25</td>\n      <td>0.85</td>\n    </tr>\n    <tr>\n      <th>33</th>\n      <td>8.50</td>\n      <td>0.95</td>\n    </tr>\n    <tr>\n      <th>34</th>\n      <td>8.75</td>\n      <td>2.35</td>\n    </tr>\n    <tr>\n      <th>35</th>\n      <td>9.00</td>\n      <td>0.69</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>9.25</td>\n      <td>1.31</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>9.50</td>\n      <td>0.66</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>9.75</td>\n      <td>0.72</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>10.00</td>\n      <td>0.21</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndata.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=29}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Depth</th>\n      <th>Nporosity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.25</td>\n      <td>-1.37</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.50</td>\n      <td>-2.08</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.75</td>\n      <td>-1.67</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1.00</td>\n      <td>-1.16</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1.25</td>\n      <td>-0.24</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndata.tail()\n```\n\n::: {.cell-output .cell-output-display execution_count=30}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Depth</th>\n      <th>Nporosity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>35</th>\n      <td>9.00</td>\n      <td>0.69</td>\n    </tr>\n    <tr>\n      <th>36</th>\n      <td>9.25</td>\n      <td>1.31</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>9.50</td>\n      <td>0.66</td>\n    </tr>\n    <tr>\n      <th>38</th>\n      <td>9.75</td>\n      <td>0.72</td>\n    </tr>\n    <tr>\n      <th>39</th>\n      <td>10.00</td>\n      <td>0.21</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## \n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndata.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=31}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Depth</th>\n      <th>Nporosity</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>40.000000</td>\n      <td>40.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>5.125000</td>\n      <td>0.022250</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>2.922613</td>\n      <td>0.992111</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>0.250000</td>\n      <td>-2.080000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>2.687500</td>\n      <td>-0.757500</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>5.125000</td>\n      <td>0.140000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>7.562500</td>\n      <td>0.742500</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>10.000000</td>\n      <td>2.350000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n##\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nimport plotnine \nfrom plotnine import *\nggplot(data, aes(x=\"Depth\", y=\"Nporosity\"))+geom_line() + geom_point()\n```\n\n::: {.cell-output .cell-output-display}\n![](week10_files/figure-revealjs/cell-6-output-1.png){}\n:::\n\n::: {.cell-output .cell-output-display execution_count=32}\n```\n<ggplot: (288689448)>\n```\n:::\n:::\n\n\n## variogram ploting with skgstat\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n#pip install scikit-gstat\nimport skgstat as skg\nV = skg.Variogram(data['Depth'], data['Nporosity'])\nV.plot()\n```\n\n::: {.cell-output .cell-output-display execution_count=33}\n![](week10_files/figure-revealjs/cell-7-output-1.png){width=667 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](week10_files/figure-revealjs/cell-7-output-2.png){width=667 height=431}\n:::\n:::\n\n\n## Increase the number of lags\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nV.maxlag = 25\nV.n_lags = 25\nV.plot()\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n![](week10_files/figure-revealjs/cell-8-output-1.png){width=667 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](week10_files/figure-revealjs/cell-8-output-2.png){width=667 height=431}\n:::\n:::\n\n\n##\n\n\nThe data set includes 40 observations, consequently we can increase the number of lag classes. \n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nV.maxlag = 40\nV.n_lags = 40\nV.plot()\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n![](week10_files/figure-revealjs/cell-9-output-1.png){width=663 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](week10_files/figure-revealjs/cell-9-output-2.png){width=663 height=431}\n:::\n:::\n\n\n## To iluustrate the other parameters in the skg.Variogram\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\nV = skg.Variogram(data['Depth'], data['Nporosity'],\n              normalize = False, model = \"spherical\", use_nugget = True,\n              n_lags=40, maxlag=40)\nV.plot()             \n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n![](week10_files/figure-revealjs/cell-10-output-1.png){width=663 height=431}\n:::\n\n::: {.cell-output .cell-output-display}\n![](week10_files/figure-revealjs/cell-10-output-2.png){width=663 height=431}\n:::\n:::\n\n\n## For more details\n\nhttps://scikit-gstat.readthedocs.io/en/latest/reference/variogram.html\n\n## Calculating Experimental Variograms\n\n\n![](search_template_1.png)\n\nSource: [here](https://aegis4048.github.io/spatial-simulation-1-basics-of-variograms)\n\n##\n\n![](searchtem.png)\n\nsource: Vega, A. N. (1995). Geostatistical Analysis Applied to Mine Waste Characterization and Remediation (Doctoral dissertation, Colorado School of Mines).\n\n## In-class: search template \n\n## In-class: seach template (scan across all possible locations)\n\n## Choosing the directions (Choice of Azimuth (Directionality))\n\n![](variogram_step_1.png)\n\nSource: [here](https://aegis4048.github.io/spatial-simulation-1-basics-of-variograms)\n\n## How do we find what directions you should calculate the variogram?\n\n- Explore data\n\n- Combining knowledge of geologists\n\n- Azimuth angle in degrees clockwise from north\n\n##\n\n![](dv.jpeg)\n\n \nSource: Trevisani, S., Cavalli, M., & Marchi, L. (2009). Variogram maps from LiDAR data as fingerprints of surface morphology on scree slopes. Natural Hazards and Earth System Sciences, 9(1), 129-133.\n\n##\n\n![](dv.jpeg)\n\nRelationship between the variogram map and directional variograms. a) variogram 7 map of elevation data with profiles of directional variograms; b) directional variogram 8 calculated along the direction of maximum continuity, (dashed line in a); c) directional 9 variogram calculated along the direction of minimum continuity (continuous line in a)\n\n## Guidance for Paprameter Setting when Calculating Variograms\n\n- Lag separation: coincide with minimum data spacing\n\n- Lag tolerance - 1/2 lag separation distance\n\n- The variogram is only valid for a distance one-half of the field size.\n\n##\n\n![](calv.png)\n\nDirectly taken from https://www.youtube.com/playlist?list=PLG19vXLQHvSB-D4XKYieEku9GQMQyAzjJ. \n\n\n## \n\nIsotropic: independent of the direction of measurement \n##\n\n![](ap_compare.png)\n\nSource: https://geostatisticslessons.com/lessons/variogramanisotropy\n\n## In-class\n\nVariogram calculation in major and minor directions\n\n## Python tutorials\n\n[Tute 1 ](https://github.com/GeostatsGuy/PythonNumericalDemos/blob/master/GeostatsPy_variogram_calculation.ipynb)\n\n[Tute 2](https://github.com/GeostatsGuy/PythonNumericalDemos/blob/master/Interactive_Variogram_Calculation.ipynb)\n\n[Tute 3](https://scikit-gstat.readthedocs.io/en/latest/auto_examples/tutorial_03_variogram_models.html)\n\n## Variogram Interpretations\n\n![](70anisotropymapbined.png)\n\nSource: https://www.researchgate.net/post/How-can-I-estimate-the-major-axis-and-ratio-values-from-directional-variogram-for-modeling-anisotropy\n\n## Geometric Ansotropy\n\n![](70anisotropymapbined.png)\n\n\n## Other pattersn\n\n- Cyclic\n\n- Trend\n\n- Zonal Anisotropy\n\n##\n\n![](trend.jpeg)\nSource:https://www.researchgate.net/publication/341763241_Spatio-temporal_analysis_of_rainfall_extremes_in_the_flood-prone_Nagavali_and_Vamsadhara_Basins_in_eastern_India/figures?lo=1\n\n##\n\n![](srilanka.jpeg)\n\nSource:https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.6405\n\n##\n\n![](cyclic.png)\n\nhttps://esurf.copernicus.org/articles/9/845/2021/\n\n## Variogram modelling\n\n![](vmodes.gif)\n\n## Python tutorial\n\n[Tute 3](https://scikit-gstat.readthedocs.io/en/latest/auto_examples/tutorial_03_variogram_models.html)\n\n",
    "supporting": [
      "week10_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}